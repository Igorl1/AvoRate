<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    {% include 'tracker/header.html' %}
    <title>
      AvoRate - Rate & Review
      {{ item.title if item is defined else 'media' }}
    </title>
  </head>
  <body>
    {% include 'tracker/global_links.html' %}

    <main class="page-container">
      <section class="card">
        <a href="#" class="btn-ghost" style="margin-bottom: 1rem">
          <!-- backend: change href="#" to url_for('tracker.home') or item detail -->
          ‚Üê Back to dashboard
        </a>

        <div
          style="
            display: flex;
            gap: 1rem;
            align-items: flex-start;
            flex-wrap: wrap;
          "
        >
          <div style="min-width: 140px; flex: 1 1 0">
            <div
              class="media-detail-poster"
              style="max-width: 220px; height: 320px"
            ></div>
          </div>

          <div style="flex: 2 1 260px">
            <h1 class="page-title" style="margin-bottom: 0.25rem">
              {{ item.title if item is defined else 'Media title' }}
            </h1>
            <p
              class="text-muted"
              style="margin: 0 0 0.75rem; font-size: 0.9rem"
            >
              {{ item.media_type or '' }}
              {% if item.year %} ‚Ä¢ {{ item.year }}{% endif %}
            </p>

            <div class="media-rating-row" style="margin-bottom: 0.75rem">
              <span class="text-muted">Your current rating:</span>
              <span class="avo-row">
                {% set user_rating = item.rating if item is defined and item.rating is not none else 0 %}
                {% if user_rating %}
                {% set full = user_rating // 2 %}
                {% for _ in range(full) %}
                <span class="avo">ü•ë</span>
                {% endfor %}
                <span style="margin-left: 0.25rem">{{ user_rating }}/10</span>
                {% else %}
                <span class="text-muted">no rating</span>
                {% endif %}
              </span>
            </div>

            <form class="form" method="POST" action="">
              <div class="form-field">
                <label for="rating">Rating (0 to 10)</label>
                <input
                  id="rating"
                  name="rating"
                  type="number"
                  min="0"
                  max="10"
                  step="1"
                  value="{{ user_rating if user_rating else '' }}"
                />
              </div>

              <div class="form-field">
                <label for="review">Add a review...</label>
                <textarea
                  id="review"
                  name="review"
                  placeholder="Write here what you thought about the media"
                >{{ item.review if item is defined else '' }}</textarea>
              </div>

              <div class="form-actions">
                <button type="submit" class="btn-primary">Save</button>
              </div>
            </form>
          </div>
        </div>
      </section>
    </main>
  </body>
</html>
